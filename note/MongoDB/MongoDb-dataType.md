### mongoDB 支持的数据类型

> 要了解的一个基础知识，在编写后端的时候，可能会在这种地方犯错，检查都不好检查。

- MongoDB 文档存储是使用 BSON 类型，BSON（BSON short for Bin­ary JSON, is a bin­ary-en­coded seri­al­iz­a­tion of JSON-like doc­u­ments）是二进制序列化的形式。类如 JSON，同样支持内嵌各种类型。

- MongoDB 的单个实例可以容纳多个独立的数据库，每一个都有自己的集合和权限，不同的数据库也放置在不同的文件中

| **数据类型 **      | **描述**                                                                                                   |
| ------------------ | ---------------------------------------------------------------------------------------------------------- |
| String             | 字符串。存储数据常用的数据类型。在 MongoDB 中，UTF-8 编码的字符串才是合法的。                              |
| Integer            | 整型数值。用于存储数值。根据你所采用的服务器，可分为 32 位或 64 位。                                       |
| Boolean            | 布尔值。用于存储布尔值（真/假）。                                                                          |
| Double             | 双精度浮点值。用于存储浮点值。                                                                             |
| Min/Max keys       | 将一个值与 BSON（二进制的 JSON）元素的最低值和最高值相对比。                                               |
| Array              | 用于将数组或列表或多个值存储为一个键。                                                                     |
| Timestamp          | 时间戳。记录文档修改或添加的具体时间。                                                                     |
| Object             | 用于内嵌文档。                                                                                             |
| Null               | 用于创建空值。                                                                                             |
| Symbol             | 符号。该数据类型基本上等同于字符串类型，但不同的是，它一般用于采用特殊符号类型的语言。                     |
| Date               | 日期时间。用 UNIX 时间格式来存储当前日期或时间。你可以指定自己的日期时间：创建 Date 对象，传入年月日信息。 |
| Object ID          | 对象 ID。用于创建文档的 ID。　　(每个文档都有)                                                             |
| Binary Data        | 二进制数据。用于存储二进制数据。                                                                           |
| Code               | 代码类型。用于在文档中存储 JavaScript 代码。                                                               |
| Regular expression | 正则表达式                                                                                                 |

#### ObjectId

ObjectId 类似唯一主键，可以很快的去生成和排序，包含 12 bytes，含义是：

- 前 4 个字节表示创建 unix 时间戳,格林尼治时间 UTC 时间，比北京时间晚了 8 个小时

- 接下来的 3 个字节是机器标识码

- 紧接的两个字节由进程 id 组成 PID

- 最后三个字节是随机数

> MongoDB 中存储的文档必须有一个 \_id 键。这个键的值可以是任何类型的，默认是个 ObjectId 对象
> 由于 ObjectId 中保存了创建的时间戳，所以你不需要为你的文档保存时间戳字段，你可以通过 getTimestamp 函数来获取文档的创建时间:

#### 字符串

BSON 字符串都是 UTF-8 编码。

#### 时间戳

BSON 有一个特殊的时间戳类型用于 MongoDB 内部使用，与普通的**日期**类型不相关。 时间戳值是一个 64 位的值。其中：

前 32 位是一个 `time_t` 值（与 Unix 新纪元相差的秒数）
后 32 位是在某秒中操作的一个递增的序数
在单个 mongod 实例中，时间戳值通常是唯一的。

在复制集中， `oplog` 有一个 `ts` 字段。这个字段中的值使用 BSON 时间戳表示了操作时间。

BSON 时间戳类型主要用于 MongoDB 内部使用。在大多数情况下的应用开发中，你可以使用 BSON 日期类型。

#### 日期

表示当前距离 Unix 新纪元（1970 年 1 月 1 日）的毫秒数。日期类型是有符号的, 负数表示 1970 年之前的日期。

#### 举例

```JavaScript
null：d={'x':null}                        用于表示空或不存在的字段

布尔型：d={'x':true,'y':false}     注意是js的true和false不是Python的True和False

数值：d={'x':3,'y':3.1415926}      支持整型和浮点型

字符串：d={'x':'Damon'}             与Python字符串一致，没啥好说的

日期：d={'x':new Date()}            是一个时间对象

数组：d={'x':[1,'a','v']}                 索引从0开始

user={'name':'egon','addr':{'country':'China','city':'YT'}}        类似于字典套字典，取值形式为user.addr.country

对象id:d={'x':ObjectId()}             MongoDB插数据时不指定_id的话默认就是用这种形式自增的，好处是绝对唯一。是一个12字节的ID，是文档的唯一标识，不可变

正则表达式：d={'pattern':/^egon.*?nb$/i}　           正则写在／／内，后面的i代表:
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　i 忽略大小写
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　m 多行匹配模式
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　x 忽略非转义的空白字符
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　s 单行匹配模式

```

#### 参考文献

- [mongoDB 支持的数据类型](https://blog.csdn.net/u013278099/article/details/88829986)
